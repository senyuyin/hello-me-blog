{"ast":null,"code":"import _regeneratorRuntime from\"/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./write.css';import{useState,useContext}from'react';import axios from'axios';import{Context}from'../../context/Context';import browserHistory from'../../history/history';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;function getRandomInt(max){return Math.floor(Math.random()*max);}var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,filename,photos,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=17;break;}data=new FormData();filename=Date.now()+file.name;data.append('name',filename);data.append('file',file);newPost.photo=filename;_context.prev=8;_context.next=11;return axios.post('/upload',data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.next=19;break;case 17:photos=['1625881510282book-with-green-board-background.jpg','1625881815139book-with-green-board-background.jpg','1625881847297back-school-background-with-school-supplies-chalkboard.jpg','16259025383721440x900_791d4a9bd6cc529.jpeg','162590931057220190928013027762.jpeg','162590961528320.jpg','162590973708521.jpg','162597197487624.jpg','162597197618724.jpg','162597213410824.jpg','162597213527724.jpg','162598695236422.jpg','162598848877521.jpg','162599120792120.jpg','1626054591670focus-647c57d2effb7d2dfb5871161afab3cf097de6339c02e85d84ea14747800fcb0.png','16260554820934bb3e43f66b5a919fea1a9005be11b86.jpeg'];newPost.photo=photos[getRandomInt(photos.length)]||'1625881510282book-with-green-board-background.jpg';case 19:_context.prev=19;_context.next=22;return axios.post(\"/posts\",newPost);case 22:res=_context.sent;console.log(res.data);//    window.location.replace('/post/'+ res.data._id);\nbrowserHistory.replace({pathname:'/post/'+res.data._id});browserHistory.go(0);_context.next=30;break;case 28:_context.prev=28;_context.t1=_context[\"catch\"](19);case 30:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[19,28]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),alt:\"\",className:\"writeImg\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:'none'},onChange:function onChange(e){setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"sources":["/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/src/pages/write/Write.jsx"],"names":["useState","useContext","axios","Context","browserHistory","Write","title","setTitle","desc","setDesc","file","setFile","user","getRandomInt","max","Math","floor","random","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","photos","length","res","console","log","replace","pathname","_id","go","URL","createObjectURL","display","target","files","value"],"mappings":"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","sourcesContent":["import './write.css'\nimport { useState,useContext } from 'react'\nimport axios from 'axios'\nimport { Context } from '../../context/Context'\nimport browserHistory from '../../history/history'\n\nexport default function Write() {\n    const [title, setTitle] = useState('')\n    const [desc, setDesc] = useState('')\n    const [file, setFile] = useState(null)\n    const {user} = useContext(Context)\n\n    function getRandomInt(max) {\n        return Math.floor(Math.random() * max);\n      }\n\n    const handleSubmit = async (e)=>{\n        e.preventDefault();\n        const newPost = {\n            username: user.username,\n            title,\n            desc\n        }\n        if(file){\n            const data =new FormData();\n            const filename = Date.now() + file.name;\n            data.append('name', filename);\n            data.append('file', file);\n            newPost.photo = filename;\n            try{\n                await axios.post('/upload', data);\n            }catch(err){\n\n            }\n        }else{\n            const photos = ['1625881510282book-with-green-board-background.jpg',\n                '1625881815139book-with-green-board-background.jpg',\n                '1625881847297back-school-background-with-school-supplies-chalkboard.jpg',\n                '16259025383721440x900_791d4a9bd6cc529.jpeg',\n                '162590931057220190928013027762.jpeg',\n                '162590961528320.jpg',\n                '162590973708521.jpg',\n                '162597197487624.jpg',\n                '162597197618724.jpg',\n                '162597213410824.jpg',\n                '162597213527724.jpg',\n                '162598695236422.jpg',\n                '162598848877521.jpg',\n                '162599120792120.jpg',\n                '1626054591670focus-647c57d2effb7d2dfb5871161afab3cf097de6339c02e85d84ea14747800fcb0.png',\n                '16260554820934bb3e43f66b5a919fea1a9005be11b86.jpeg',]\n            newPost.photo = photos[getRandomInt(photos.length)]||'1625881510282book-with-green-board-background.jpg'\n        }\n\n        try {\n           const res = await axios.post(\"/posts\", newPost);\n           console.log(res.data)\n        //    window.location.replace('/post/'+ res.data._id);\n           browserHistory.replace({pathname: '/post/'+ res.data._id});\n           browserHistory.go(0);\n        } catch (error) {\n            \n        }\n    }\n\n    return (\n        <div className='write'>\n            {file&&<img src={URL.createObjectURL(file)} alt=\"\" className=\"writeImg\" />}\n            <form className=\"writeForm\" onSubmit={handleSubmit}>\n                <div className=\"writeFormGroup\">\n                    <label htmlFor=\"fileInput\"><i className=\"writeIcon fas fa-plus\"></i></label>\n                    <input type=\"file\" id='fileInput' style={{display:'none'}} onChange={(e)=>{setFile(e.target.files[0])}}/>\n                    <input type=\"text\" placeholder='Title' className='writeInput' autoFocus={true} onChange={e=>setTitle(e.target.value)}/>\n                </div>\n                <div className=\"writeFormGroup\">\n                    <textarea placeholder='Tell your story...' type='text' className='writeInput writeText' onChange={e=>setDesc(e.target.value)}></textarea>\n                </div>\n                <button className=\"writeSubmit\" type='submit'>Publish</button>\n            </form>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}