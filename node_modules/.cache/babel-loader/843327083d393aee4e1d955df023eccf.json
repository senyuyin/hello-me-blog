{"ast":null,"code":"import _regeneratorRuntime from\"/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./write.css';import{useState,useContext}from'react';import axios from'axios';import{Context}from'../../context/Context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;function image2Base64(img){var reader=new FileReader();reader.readAsDataURL(img);var res='';reader.onload=function(){res=reader.result;//base64encoded string\nsetFile(res);console.log(res);};}var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(file){newPost.photo=file;}_context.prev=3;_context.next=6;return axios.post(\"/posts\",newPost);case 6:res=_context.sent;console.log(res.data);window.location.replace('/post/'+res.data._id);_context.next=13;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);case 13:case\"end\":return _context.stop();}}},_callee,null,[[3,11]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{src:file,alt:\"\",className:\"writeImg\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:'none'},onChange:function onChange(e){image2Base64(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"sources":["/Users/wuyubao/Desktop/vscode-web/heroku-node-app/client/src/pages/write/Write.jsx"],"names":["useState","useContext","axios","Context","Write","title","setTitle","desc","setDesc","file","setFile","user","image2Base64","img","reader","FileReader","readAsDataURL","res","onload","result","console","log","handleSubmit","e","preventDefault","newPost","username","photo","post","data","window","location","replace","_id","display","target","files","value"],"mappings":"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","sourcesContent":["import './write.css'\nimport { useState,useContext } from 'react'\nimport axios from 'axios'\nimport { Context } from '../../context/Context'\n\nexport default function Write() {\n    const [title, setTitle] = useState('')\n    const [desc, setDesc] = useState('')\n    const [file, setFile] = useState('')\n    const {user} = useContext(Context)\n\n    function image2Base64(img) {  \n        var reader = new FileReader();\n        reader.readAsDataURL(img);\n\n        var res='';\n        reader.onload = function () {\n            res = reader.result;//base64encoded string\n            setFile(res);\n            console.log(res);\n        };\n\n   }  \n\n    const handleSubmit = async (e)=>{\n        e.preventDefault();\n        const newPost = {\n            username: user.username,\n            title,\n            desc\n        }\n        if(file){\n            newPost.photo=file;\n        }\n\n        try {\n           const res = await axios.post(\"/posts\", newPost);\n           console.log(res.data)\n           window.location.replace('/post/'+ res.data._id);\n        } catch (error) {\n            \n        }\n    }\n\n    return (\n        <div className='write'>\n            {file&&<img src={file} alt=\"\" className=\"writeImg\" />}\n            <form className=\"writeForm\" onSubmit={handleSubmit}>\n                <div className=\"writeFormGroup\">\n                    <label htmlFor=\"fileInput\"><i className=\"writeIcon fas fa-plus\"></i></label>\n                    <input type=\"file\" id='fileInput' style={{display:'none'}} onChange={(e)=>{image2Base64(e.target.files[0])}}/>\n                    <input type=\"text\" placeholder='Title' className='writeInput' autoFocus={true} onChange={e=>setTitle(e.target.value)}/>\n                </div>\n                <div className=\"writeFormGroup\">\n                    <textarea placeholder='Tell your story...' type='text' className='writeInput writeText' onChange={e=>setDesc(e.target.value)}></textarea>\n                </div>\n                <button className=\"writeSubmit\" type='submit'>Publish</button>\n            </form>\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}